<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Introduction · Spherical Harmonic Transforms</title><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Spherical Harmonic Transforms</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">SphericalHarmonicTransforms.jl Documentation</a></li><li><span class="tocitem">Spherical Harmonic Transforms</span><ul><li class="is-active"><a class="tocitem" href>Introduction</a><ul class="internal"><li><a class="tocitem" href="#spharms-defn"><span>Definition</span></a></li><li><a class="tocitem" href="#Real-Symmetries"><span>Real Symmetries</span></a></li><li><a class="tocitem" href="#FFT-based-Ring-Transforms"><span>FFT-based Ring Transforms</span></a></li></ul></li><li><a class="tocitem" href="../usage/">Usage</a></li><li><a class="tocitem" href="../devdocs/">Developer Documentation</a></li><li><a class="tocitem" href="../references/">Literature/References</a></li></ul></li><li><a class="tocitem" href="../../lib/public/">API Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Spherical Harmonic Transforms</a></li><li class="is-active"><a href>Introduction</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Introduction</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/jmert/SphericalHarmonicTransforms.jl/blob/master/docs/src/man/intro.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="intro"><a class="docs-heading-anchor" href="#intro">Introduction</a><a id="intro-1"></a><a class="docs-heading-anchor-permalink" href="#intro" title="Permalink"></a></h1><ul><li><a href="#intro">Introduction</a></li><li class="no-marker"><ul><li><a href="#spharms-defn">Definition</a></li><li><a href="#Real-Symmetries">Real Symmetries</a></li><li><a href="#FFT-based-Ring-Transforms">FFT-based Ring Transforms</a></li></ul></li></ul><h2 id="spharms-defn"><a class="docs-heading-anchor" href="#spharms-defn">Definition</a><a id="spharms-defn-1"></a><a class="docs-heading-anchor-permalink" href="#spharms-defn" title="Permalink"></a></h2><p>The spherical harmonics <span>$Y_\ell^m(\theta,\phi)$</span> arise from solving Laplace&#39;s equation</p><p class="math-container">\[\begin{align}
    \nabla^2 \psi = 0
\end{align}\]</p><p>in spherical coordinates. The equation is separable into a radial component <span>$R(r)$</span> and an angular part <span>$Y(\theta,\phi)$</span> such that the total solution is <span>$\psi(r,\theta,\phi) \equiv R(r)Y(\theta,\phi)$</span>. We ignore the radial component and continue with only the angular part.</p><p>The second-order differential equation for the angular component, written in the standard physicists&#39; form where <span>$\theta$</span> is the colatitude and <span>$\phi$</span> the azimuth angles, is</p><p class="math-container">\[\begin{align}
    \frac{1}{\sin\theta} \frac{\partial}{\partial\theta}
        \left( \sin\theta \frac{\partial}{\partial\theta} Y \right)
        + \frac{1}{\sin^2\theta} \frac{\partial^2}{\partial\phi^2} Y
        + \ell(\ell+1) Y &amp;= 0
\end{align}\]</p><p>The differential equation is further separable among the two angular coordinates, with the result being a family of solutions parameterized by the integer constants <span>$\ell &gt; 0$</span> and <span>$|m| &lt; \ell$</span>. Including normalization factors<sup class="footnote-reference"><a id="citeref-norm" href="#footnote-norm">[norm]</a></sup>, the spherical harmonics <span>$Y_{\ell m}(\theta,\phi)$</span> can be written as</p><p class="math-container">\[\begin{align}
    Y_{\ell m}(\theta, \phi) &amp;\equiv
        \sqrt{\frac{2\ell+1}{4\pi} \frac{(\ell-m)!}{(\ell+m)!}}
        P_\ell^m(\cos\theta) \, e^{im\phi}
    = \lambda_\ell^m(\cos\theta) \, e^{im\phi}
\end{align}\]</p><p>where <span>$\lambda_\ell^m(\cos\theta)$</span> are pre-normalized Associated Legendre Polynomials for spherical harmonic transforms (see <a href="https://github.com/jmert/AssociatedLegendrePolynomials.jl"><code>AssociatedLegendrePolynomials.jl</code></a>) and <span>$e^{im\phi}$</span> are the complex exponentials.</p><p>The spherical harmonics are a complete, orthonormal basis for functions on the sphere <span>$(\theta,\phi) \in \mathbb{S} = [0,\pi]\times[0,2\pi]$</span>. Therefore they satisfy the condition that</p><p class="math-container">\[\begin{align*}
    \int_\mathbb{S} Y_{\ell m}(\theta,\phi) Y_{\ell&#39; m&#39;}(\theta,\phi)
        \,d\Omega &amp;= \delta_{\ell\ell&#39;} \delta_{mm&#39;}
\end{align*}\]</p><p>where <span>$d\Omega = \sin\theta \,d\theta\,d\phi$</span>.</p><p>It then follows that an arbitrary function on the sphere <span>$f(\theta,\phi)$</span> can be harmonically decomposed into an ensemble of coefficients <span>$a_{\ell m}$</span>:</p><p class="math-container">\[\begin{align}
    a_{\ell m} &amp;= \int_\mathbb{S} f(\theta, \phi) \overline{Y_{\ell m}}(\theta,\phi) \,d\Omega
\end{align}\]</p><p>where the overline on <span>$\overline{Y_{\ell m}}$</span> denotes complex conjugation. The function is (re)synthesized from the <span>$a_{\ell m}$</span>s as the linear combination of the spherical harmonics:</p><p class="math-container">\[\begin{align}
    f(\theta,\phi) &amp;= \sum_{\ell=0}^{\ell_\mathrm{max}}
        \sum_{m=-\ell}^{\ell} a_{\ell m} Y_{\ell m}(\theta,\phi)
        \label{eqn:complex_synthesis}
\end{align}\]</p><h2 id="Real-Symmetries"><a class="docs-heading-anchor" href="#Real-Symmetries">Real Symmetries</a><a id="Real-Symmetries-1"></a><a class="docs-heading-anchor-permalink" href="#Real-Symmetries" title="Permalink"></a></h2><p>In general, <span>$f$</span> may be a complex function (i.e. <span>$f : \mathbb{S} \rightarrow \mathbb{C}$</span>), but if it is a real function (<span>$f : \mathbb{S} \rightarrow \mathbb{R}$</span>), then there are some additional symmetries of note.</p><p>First, due to an underlying property of the Associated Legendre polynomials, the negative orders (<span>$m &lt; 0$</span>) are related to the positive orders according to</p><p class="math-container">\[\begin{align}
    Y_{\ell (-m)}(\theta,\phi) &amp;= (-1)^m \,\overline{Y_{\ell (+m)}}(\theta,\phi)
\end{align}\]</p><p>Given this relationship between the positive and negative orders, the harmonic coefficients have a similar property as well, with</p><p class="math-container">\[\begin{align}
    a_{\ell(-m)} &amp;= (-1)^m \,\overline{a_{\ell(+m)}}
\end{align}\]</p><p>This directly constraints the order <span>$m = 0$</span> modes to being real coefficients since <span>$x = \overline x$</span> if and only if <span>$x$</span> is real. Furthermore, this permits the synthesis to be performed using a sum over the range of integers <span>$m = [0, \ell]$</span> instead of <span>$[-\ell, \ell]$</span> because by pairwise summing the postive and negative orders with each other, we find:</p><p class="math-container">\[\begin{align*}
    a_{\ell(-m)} Y_{\ell (-m)} + a_{\ell(+m)} Y_{\ell (+m)} &amp;=
        (-1)^m \,\overline{a_{\ell(+m)}} \cdot (-1)^m \,\overline{Y_{\ell (+m)}} +
        a_{\ell(+m)} Y_{\ell (+m)} \\
    {} &amp;= \overline{a_{\ell(+m)} Y_{\ell (+m)}} + a_{\ell(+m)} Y_{\ell (+m)} \\
    {} &amp;= 2 \operatorname{Re}\left[ a_{\ell(+m)} Y_{\ell (+m)} \right]
\end{align*}\]</p><p>Note that this excludes the <span>$m = 0$</span> cases which have no pair so there needs to be an extra multiplicity factor in the summation — for instance, choosing a notation that uses the Kronecker delta, <span>$(2-\delta_{m0}) = \begin{cases} 1 &amp; \text{if } m=0 \\ 2 &amp; \text{otherwise} \end{cases}$</span>, and</p><p class="math-container">\[\begin{align}
    f(\theta,\phi) &amp;= \sum_{\ell=0}^{\ell_\mathrm{max}}
        \sum_{m=0}^{\ell} (2 - \delta_{m0}) a_{\ell m} Y_{\ell m}(\theta,\phi)
\end{align}\]</p><p>A similar argument applies to harmonic analysis of a field into the <span>$a_{\ell m}$</span> coefficients except there is no need for an extra multiplicity factor; instead you simply run the integration for only the non-negative orders.</p><p>The second useful symmetry is that the Legendre polynomials are even/odd for even/odd combinations of orders and degrees, so the spherical harmonics inherit the even/odd symmetry across the equator:</p><p class="math-container">\[\begin{align}
    P_\ell^m(-z) = (-1)^{\ell+m} P_\ell^m(z)
    \quad\Rightarrow\quad
    Y_{\ell m}(\pi - \theta, \phi) = (-1)^{\ell+m} Y_{\ell m}(\theta,\phi)
\end{align}\]</p><p>This is a useful property when it comes to designing pixelization schemes on the sphere since symmetry over the equator allows for reuse in the calculation of Legendre polynomials for pairs of latitudes with only a much [computationally] cheaper negation required of one of half of the pair.</p><h2 id="FFT-based-Ring-Transforms"><a class="docs-heading-anchor" href="#FFT-based-Ring-Transforms">FFT-based Ring Transforms</a><a id="FFT-based-Ring-Transforms-1"></a><a class="docs-heading-anchor-permalink" href="#FFT-based-Ring-Transforms" title="Permalink"></a></h2><p>If the sphere is discretized by a series of isolatitude rings, each of which are comprised of uniformly-spaced pixels in azimuth, then the fast Fourier transform (FFT) may be employed to reduce the computational complexity of the transform.</p><p>Starting from Eqn. <span>$\ref{eqn:complex_synthesis}$</span>, changing the order of summation so that the sums over degrees <span>$\ell$</span> are done before the order <span>$m$</span> reveals the inner summation in a form which corresponds to a discrete Fourier transform.</p><p class="math-container">\[\begin{align*}
    \def\ellmax{\ell_{\mathrm{max}}}
    f(\theta,\phi) &amp;= \sum_{m=-\ellmax}^{\ellmax}
        \left[ \sum_{\ell=|m|}^{\ellmax} a_{\ell m} \lambda_\ell^m(\cos\theta) \right]
        e^{im\phi}
\end{align*}\]</p><p>Then for uniformly spaced pixels in the ring, the azimuth coordinates are</p><p class="math-container">\[\begin{align*}
    \phi_k = \phi_0 + \frac{2\pi k}{N_\phi}
\end{align*}\]</p><p>where <span>$\phi_0$</span> is the offset of the first pixel in the ring away from <span>$\phi = 0$</span>, <span>$N_\phi$</span> is the number of pixels in the ring, and <span>$k$</span> is an integer in <span>$[0, N_\phi - 1]$</span>. Combined with the reordered summation, the expression can be rewritten as</p><p class="math-container">\[\begin{align*}
    \def\ellmax{\ell_{\mathrm{max}}}
    f(\theta,\phi_k) &amp;= \sum_{m=-\ellmax}^{\ellmax} g_m e^{2\pi imk/N_\phi}
    &amp;\text{where }
        g_m \equiv e^{im\phi_0} \sum_{\ell=|m|}^{\ellmax} a_{\ell m} \lambda_\ell^m(\cos\theta)
\end{align*}\]</p><p>The summation on the left is discrete Fourier transform of the coefficients <span>$g_m$</span>. When <span>$N_\phi = 2\ellmax + 1$</span>, the correspondance to the FFT is exact, and <span>$f(\theta, \phi_k) = \mathcal{F}^{-1}(g_m)$</span>, using <a href="http://www.fftw.org/">FFTW</a>&#39;s sign convention and <span>$\mathcal{F}$</span> and <span>$\mathcal{F}^{-1}$</span> are the foward and inverse FFT operations, respectively. Also recall that &quot;negative frequencies&quot; are just a matter of interpretation and are equivalent to a higher positive frequency one period later. For instance, the <span>$m = -1$</span> term is equivalent in the Fourier transform to the <span>$(N_\phi - 1)$</span>-th Fourier frequency.</p><p>For cases when <span>$N_\phi \neq 2\ellmax + 1$</span>, the summation must be properly zero-padded or alias-truncated — for further details, see <a href="../references/#bib-spharms">Notes on Calculating the Spherical Harmonics (Spherical Harmonics Series, Part I)</a>.</p><section class="footnotes is-size-7"><ul><li class="footnote" id="footnote-norm"><a class="tag is-link" href="#citeref-norm">norm</a>Be aware that there are multiple conventions for how to define the spherical harmonics that differ in the details of the normalization factors. For instance, the so-called <a href="https://mathworld.wolfram.com/Condon-ShortleyPhase.html">Condon-Shortley phase factor</a> of <span>$(-1)^m$</span> can either be omitted entirely, included as an explicit term in the normalization of the spherical harmonics, or included as an explicit symmetry in the definition of the Legendre polynomials. We use this last option here, which is also consistent with typical physicists&#39; experience in e.g. <em>Classical Electrodynamics</em> by <a href="../references/#bib-spharms">J.D. Jackson</a>. See also <a href="../references/#bib-spharms">Abramowitz &amp; Stegun</a>.</li></ul></section></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../">« SphericalHarmonicTransforms.jl Documentation</a><a class="docs-footer-nextpage" href="../usage/">Usage »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.22 on <span class="colophon-date" title="Saturday 30 July 2022 22:06">Saturday 30 July 2022</span>. Using Julia version 1.7.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
